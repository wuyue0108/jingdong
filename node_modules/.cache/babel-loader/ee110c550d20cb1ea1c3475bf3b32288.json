{"remainingRequest":"C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\src\\views\\orderConfirmation\\Bottom.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\src\\views\\orderConfirmation\\Bottom.vue","mtime":1616563556681},{"path":"C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL1dZL0Rlc2t0b3Avd3lfcGFja2V0L1x1NTI0RFx1N0FFRi9WVUUvamluZ2Rvbmcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCB7IHJlZiB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IHVzZUNvbW1vbkNhcnRFZmZlY3QgfSBmcm9tICcuLi8uLi9lZmZlY3RzL2NhcnRFZmZlY3QnOwppbXBvcnQgeyB1c2VSb3V0ZSwgdXNlUm91dGVyIH0gZnJvbSAndnVlLXJvdXRlcic7CmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IHBvc3QgfSBmcm9tICcuLi8uLi91dGlscy9yZXF1ZXN0LmpzJzsKCnZhciB1c2VPcmRlclN1Ym1taXRFZmZlY3QgPSBmdW5jdGlvbiB1c2VPcmRlclN1Ym1taXRFZmZlY3QocHJvZHVjdExpc3QsIHNob3BOYW1lLCBzaG9wSWQpIHsKICB2YXIgcm91dGVyID0gdXNlUm91dGVyKCk7CiAgdmFyIHN0b3JlID0gdXNlU3RvcmUoKTsKCiAgdmFyIGhhbmRsZU9yZGVyU3VibW1pdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShpc0NhbmNlbGVkKSB7CiAgICAgIHZhciBwcm9kdWN0cywgaSwgcHJvZHVjdCwgcmVzdWx0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcHJvZHVjdHMgPSBbXTsKCiAgICAgICAgICAgICAgZm9yIChpIGluIHByb2R1Y3RMaXN0LnZhbHVlKSB7CiAgICAgICAgICAgICAgICBwcm9kdWN0ID0gcHJvZHVjdExpc3QudmFsdWVbaV07CiAgICAgICAgICAgICAgICBwcm9kdWN0cy5wdXNoKHsKICAgICAgICAgICAgICAgICAgaWQ6IHByb2R1Y3QuX2lkLAogICAgICAgICAgICAgICAgICBudW06IHByb2R1Y3QuY291bnQKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7CiAgICAgICAgICAgICAgcmV0dXJuIHBvc3QoJy9hcGkvb3JkZXInLCB7CiAgICAgICAgICAgICAgICBhZGRyZXNzSWQ6IDEsCiAgICAgICAgICAgICAgICBzaG9wSWQ6IHNob3BJZCwKICAgICAgICAgICAgICAgIHNob3BOYW1lOiBzaG9wTmFtZS52YWx1ZSwKICAgICAgICAgICAgICAgIGlzQ2FuY2VsZWQ6IGlzQ2FuY2VsZWQsCiAgICAgICAgICAgICAgICBwcm9kdWN0czogcHJvZHVjdHMKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICBpZiAocmVzdWx0LmVycm5vID09PSAwKSB7CiAgICAgICAgICAgICAgICByb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICdPcmRlckxpc3QnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHN0b3JlLmNvbW1pdCgnY2xlYXJQcm9kdWN0TGlzdCcsIHNob3BJZCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsvLyBjaGFuZ2VUb2FzdCgn55m75b2V5aSx6LSlJykKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gOTsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDIpOwoKICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1syLCA5XV0pOwogICAgfSkpOwoKICAgIHJldHVybiBmdW5jdGlvbiBoYW5kbGVPcmRlclN1Ym1taXQoX3gpIHsKICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSgpOwoKICByZXR1cm4gewogICAgaGFuZGxlT3JkZXJTdWJtbWl0OiBoYW5kbGVPcmRlclN1Ym1taXQKICB9Owp9OwoKdmFyIHVzZU1hc2tTaG93RWZmZWN0ID0gZnVuY3Rpb24gdXNlTWFza1Nob3dFZmZlY3QoKSB7CiAgdmFyIG1hc2tTaG93ID0gcmVmKGZhbHNlKTsKCiAgdmFyIGhhbmRsZU1hc2tEaXNwbGF5ID0gZnVuY3Rpb24gaGFuZGxlTWFza0Rpc3BsYXkoc3RhdGUpIHsKICAgIG1hc2tTaG93LnZhbHVlID0gc3RhdGU7CiAgfTsKCiAgcmV0dXJuIHsKICAgIG1hc2tTaG93OiBtYXNrU2hvdywKICAgIGhhbmRsZU1hc2tEaXNwbGF5OiBoYW5kbGVNYXNrRGlzcGxheQogIH07Cn07CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0JvdHRvbScsCiAgc2V0dXA6IGZ1bmN0aW9uIHNldHVwKCkgewogICAgdmFyIHJvdXRlID0gdXNlUm91dGUoKTsKICAgIHZhciBzaG9wSWQgPSByb3V0ZS5wYXJhbXMuaWQ7CgogICAgdmFyIF91c2VDb21tb25DYXJ0RWZmZWN0ID0gdXNlQ29tbW9uQ2FydEVmZmVjdCgpLAogICAgICAgIHByb2R1Y3RMaXN0ID0gX3VzZUNvbW1vbkNhcnRFZmZlY3QucHJvZHVjdExpc3QsCiAgICAgICAgc2hvcE5hbWUgPSBfdXNlQ29tbW9uQ2FydEVmZmVjdC5zaG9wTmFtZSwKICAgICAgICBjYWxjdWxhdGlvbiA9IF91c2VDb21tb25DYXJ0RWZmZWN0LmNhbGN1bGF0aW9uOwoKICAgIHZhciBfdXNlT3JkZXJTdWJtbWl0RWZmZWMgPSB1c2VPcmRlclN1Ym1taXRFZmZlY3QocHJvZHVjdExpc3QsIHNob3BOYW1lLCBzaG9wSWQpLAogICAgICAgIGhhbmRsZU9yZGVyU3VibW1pdCA9IF91c2VPcmRlclN1Ym1taXRFZmZlYy5oYW5kbGVPcmRlclN1Ym1taXQ7CgogICAgdmFyIF91c2VNYXNrU2hvd0VmZmVjdCA9IHVzZU1hc2tTaG93RWZmZWN0KCksCiAgICAgICAgbWFza1Nob3cgPSBfdXNlTWFza1Nob3dFZmZlY3QubWFza1Nob3csCiAgICAgICAgaGFuZGxlTWFza0Rpc3BsYXkgPSBfdXNlTWFza1Nob3dFZmZlY3QuaGFuZGxlTWFza0Rpc3BsYXk7CgogICAgcmV0dXJuIHsKICAgICAgY2FsY3VsYXRpb246IGNhbGN1bGF0aW9uLAogICAgICBtYXNrU2hvdzogbWFza1Nob3csCiAgICAgIGhhbmRsZU1hc2tEaXNwbGF5OiBoYW5kbGVNYXNrRGlzcGxheSwKICAgICAgaGFuZGxlT3JkZXJTdWJtbWl0OiBoYW5kbGVPcmRlclN1Ym1taXQKICAgIH07CiAgfQp9Ow=="},{"version":3,"sources":["C:\\Users\\WY\\Desktop\\wy_packet\\前端\\VUE\\jingdong\\src\\views\\orderConfirmation\\Bottom.vue"],"names":[],"mappings":";;AA4BA,SAAS,GAAT,QAAoB,KAApB;AACA,SAAS,mBAAT,QAAoC,0BAApC;AACA,SAAS,QAAT,EAAmB,SAAnB,QAAoC,YAApC;AACA,SAAS,QAAT,QAAyB,MAAzB;AACA,SAAS,IAAT,QAAqB,wBAArB;;AAEA,IAAM,qBAAoB,GAAI,SAAxB,qBAAwB,CAAC,WAAD,EAAc,QAAd,EAAwB,MAAxB,EAAmC;AAC/D,MAAM,MAAK,GAAI,SAAS,EAAxB;AACA,MAAM,KAAI,GAAI,QAAQ,EAAtB;;AACA,MAAM,kBAAiB;AAAA,uEAAI,iBAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACnB,cAAA,QADmB,GACR,EADQ;;AAEzB,mBAAS,CAAT,IAAc,WAAW,CAAC,KAA1B,EAAiC;AACzB,gBAAA,OADyB,GACf,WAAW,CAAC,KAAZ,CAAkB,CAAlB,CADe;AAE/B,gBAAA,QAAQ,CAAC,IAAT,CAAc;AAAE,kBAAA,EAAE,EAAE,OAAO,CAAC,GAAd;AAAmB,kBAAA,GAAG,EAAE,OAAO,CAAC;AAAhC,iBAAd;AACF;;AALyB;AAAA;AAAA,qBAOF,IAAI,CAAC,YAAD,EAAe;AACtC,gBAAA,SAAS,EAAE,CAD2B;AAEtC,gBAAA,MAAM,EAAN,MAFsC;AAGtC,gBAAA,QAAQ,EAAE,QAAQ,CAAC,KAHmB;AAItC,gBAAA,UAAU,EAAV,UAJsC;AAKtC,gBAAA,QAAQ,EAAR;AALsC,eAAf,CAPF;;AAAA;AAOjB,cAAA,MAPiB;;AAcvB,kBAAI,MAAM,CAAC,KAAP,KAAiB,CAArB,EAAwB;AACtB,gBAAA,MAAM,CAAC,IAAP,CAAY;AAAE,kBAAA,IAAI,EAAE;AAAR,iBAAZ;AACA,gBAAA,KAAK,CAAC,MAAN,CAAa,kBAAb,EAAiC,MAAjC;AACF,eAHA,MAGO,CACL;AACF;;AAnBuB;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAJ;;AAAA,oBAAjB,kBAAiB;AAAA;AAAA;AAAA,KAAvB;;AAsBA,SAAO;AAAE,IAAA,kBAAiB,EAAjB;AAAF,GAAP;AACF,CA1BA;;AA4BA,IAAM,iBAAgB,GAAI,SAApB,iBAAoB,GAAM;AAC9B,MAAM,QAAO,GAAI,GAAG,CAAC,KAAD,CAApB;;AACA,MAAM,iBAAgB,GAAI,SAApB,iBAAoB,CAAC,KAAD,EAAW;AACnC,IAAA,QAAQ,CAAC,KAAT,GAAiB,KAAjB;AACF,GAFA;;AAIA,SAAO;AAAE,IAAA,QAAQ,EAAR,QAAF;AAAY,IAAA,iBAAgB,EAAhB;AAAZ,GAAP;AACF,CAPA;;AASA,eAAe;AACb,EAAA,IAAI,EAAE,QADO;AAEb,EAAA,KAFa,mBAEJ;AACP,QAAM,KAAI,GAAI,QAAQ,EAAtB;AACA,QAAM,MAAK,GAAI,KAAK,CAAC,MAAN,CAAa,EAA5B;;AAFO,+BAGwC,mBAAmB,EAH3D;AAAA,QAGC,WAHD,wBAGC,WAHD;AAAA,QAGc,QAHd,wBAGc,QAHd;AAAA,QAGwB,WAHxB,wBAGwB,WAHxB;;AAAA,gCAIwB,qBAAqB,CAAC,WAAD,EAAc,QAAd,EAAwB,MAAxB,CAJ7C;AAAA,QAIC,kBAJD,yBAIC,kBAJD;;AAAA,6BAKiC,iBAAiB,EALlD;AAAA,QAKC,QALD,sBAKC,QALD;AAAA,QAKW,iBALX,sBAKW,iBALX;;AAMP,WAAO;AAAE,MAAA,WAAW,EAAX,WAAF;AAAe,MAAA,QAAQ,EAAR,QAAf;AAAyB,MAAA,iBAAiB,EAAjB,iBAAzB;AAA4C,MAAA,kBAAiB,EAAjB;AAA5C,KAAP;AACD;AATY,CAAf","sourcesContent":["<template>\r\n  <div class=\"mask\"\r\n       v-show=\"maskShow\"\r\n       @click=\"() => handleMaskDisplay(false)\">\r\n    <div class=\"mask__confirm\"\r\n         @click.stop>\r\n      <div class=\"mask__confirm__title\">确认要离开收银台？</div>\r\n      <div class=\"mask__confirm__detail\">请尽快完成支付，否则将被取消</div>\r\n      <div class=\"mask__confirm__button\">\r\n        <span class=\"mask__confirm__left\"\r\n              @click=\"() => handleOrderSubmmit(true)\">\r\n          取消订单\r\n        </span>\r\n        <span class=\"mask__confirm__right\"\r\n              @click=\"() => handleOrderSubmmit(false)\">确认支付</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"bottom\">\r\n    <div class=\"bottom__left\">实付金额 &yen;{{ calculation.totalPrice }}</div>\r\n    <div class=\"bottom__right\"\r\n         @click=\"() => handleMaskDisplay(true)\">\r\n      提交订单\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue'\r\nimport { useCommonCartEffect } from '../../effects/cartEffect'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nimport { post } from '../../utils/request.js'\r\n\r\nconst useOrderSubmmitEffect = (productList, shopName, shopId) => {\r\n  const router = useRouter()\r\n  const store = useStore()\r\n  const handleOrderSubmmit = async (isCanceled) => {\r\n    const products = []\r\n    for (let i in productList.value) {\r\n      const product = productList.value[i]\r\n      products.push({ id: product._id, num: product.count })\r\n    }\r\n    try {\r\n      const result = await post('/api/order', {\r\n        addressId: 1,\r\n        shopId,\r\n        shopName: shopName.value,\r\n        isCanceled,\r\n        products,\r\n      })\r\n      if (result.errno === 0) {\r\n        router.push({ name: 'OrderList' })\r\n        store.commit('clearProductList', shopId)\r\n      } else {\r\n        // changeToast('登录失败')\r\n      }\r\n    } catch (error) { }\r\n  }\r\n  return { handleOrderSubmmit }\r\n}\r\n\r\nconst useMaskShowEffect = () => {\r\n  const maskShow = ref(false)\r\n  const handleMaskDisplay = (state) => {\r\n    maskShow.value = state\r\n  }\r\n\r\n  return { maskShow, handleMaskDisplay }\r\n}\r\n\r\nexport default {\r\n  name: 'Bottom',\r\n  setup () {\r\n    const route = useRoute()\r\n    const shopId = route.params.id\r\n    const { productList, shopName, calculation } = useCommonCartEffect()\r\n    const { handleOrderSubmmit } = useOrderSubmmitEffect(productList, shopName, shopId);\r\n    const { maskShow, handleMaskDisplay } = useMaskShowEffect();\r\n    return { calculation, maskShow, handleMaskDisplay, handleOrderSubmmit }\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.mask {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  z-index: 1;\r\n  &__confirm {\r\n    position: absolute;\r\n    width: 3.01rem;\r\n    height: 1.57rem;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    text-align: center;\r\n    background: #ffffff;\r\n    border-radius: 0.04rem;\r\n    &__title {\r\n      margin-top: 0.24rem;\r\n      font-size: 0.18rem;\r\n      color: #333333;\r\n    }\r\n    &__detail {\r\n      margin-top: 0.08rem;\r\n      margin-bottom: 0.24rem;\r\n      font-size: 0.14rem;\r\n      color: #666666;\r\n    }\r\n    &__left,\r\n    &__right {\r\n      display: inline-block;\r\n      width: 0.8rem;\r\n      line-height: 0.32rem;\r\n      border: 0.01rem solid #4fb0f9;\r\n      border-radius: 0.16rem;\r\n      font-size: 0.14rem;\r\n    }\r\n    &__left {\r\n      margin-right: 0.24rem;\r\n      color: #0091ff;\r\n    }\r\n    &__right {\r\n      background: #4fb0f9;\r\n      color: #fff;\r\n    }\r\n  }\r\n}\r\n.bottom {\r\n  display: flex;\r\n  position: absolute;\r\n  line-height: 0.49rem;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  font-size: 0.14rem;\r\n  &__left {\r\n    flex: 1;\r\n    padding-left: 0.24rem;\r\n    color: #333;\r\n  }\r\n  &__right {\r\n    text-align: center;\r\n    width: 0.98rem;\r\n    background: #4fb0f9;\r\n    color: #fff;\r\n  }\r\n}\r\n</style>"],"sourceRoot":""}]}